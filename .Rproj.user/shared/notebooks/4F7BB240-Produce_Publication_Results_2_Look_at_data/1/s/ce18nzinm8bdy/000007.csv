"0","data(results_trajectories)"
"0","simresults<-results_trajectories"
"0","data<-simresults$rawdata$precensor # this gives a list of length (total reps done)"
"0","tinfo<-simresults$results # dim[1] of tinfo gives the parameter space that went in"
"0","tds<-simresults$parameterselections$trialdesigns"
"0","mergeacrossreps<-TRUE"
"0","plots1<-vector(mode=""list"",length=length(simresults$parameterselections$trialdesigns))"
"0","for(ip in 1:length(plots1)){"
"0","  param2hold<-data.table(carryover_t1half=0,trialdesign=ip)"
"0","  plots1[[ip]]<-plotfactortrajectories(data,tinfo,tds,param2hold,mergeacrossreps)"
"0","}"
"0","legend<-as_ggplot(get_legend(plots1[[1]]))"
"0","# Add titles"
"0","for(ip in 1:(length(plots1))){"
"0","  plots1[[ip]]<-plots1[[ip]]+theme(legend.position=""none"",text=element_text(size=10))+"
"0","#    ggtitle(simresults$parameterselections$trialdesigns[[ip]]$metadata$name_longform)"
"0","    ggtitle(paste(c("""",""A"",""B"",""C"",""D"",""E"",""F"",""G"")[ip],"
"0","                  simresults$parameterselections$trialdesigns[[ip]]$metadata$name_longform,"
"0","                  sep="". ""))+"
"0","    theme(plot.title=element_text(size=8))"
"0","}"
"0","# Repeat with carryover term"
"0","plots2<-vector(mode=""list"",length=length(simresults$parameterselections$trialdesigns))"
"0","for(ip in 1:length(plots2)){"
"0","  param2hold<-data.table(carryover_t1half=.5,trialdesign=ip)"
"0","  plots2[[ip]]<-plotfactortrajectories(data,tinfo,tds,param2hold,mergeacrossreps)"
"0","}"
"0","# Add titles"
"0","for(ip in 1:(length(plots2))){"
"0","  plots2[[ip]]<-plots2[[ip]]+theme(legend.position=""none"",text=element_text(size=10))+"
"0","#    ggtitle(simresults$parameterselections$trialdesigns[[ip]]$metadata$name_longform)"
"0","    ggtitle(paste(c("""",""E"",""F"",""G"",""H"")[ip],"
"0","                  simresults$parameterselections$trialdesigns[[ip]]$metadata$name_longform,"
"0","                  sep="". ""))+"
"0","    theme(plot.title=element_text(size=8))"
"0","}"
"0",""
"0","# adjust ylab and ylab and legends"
"0","for(ip in c(2,3,4)){"
"0","  plots1[[ip]]<-plots1[[ip]]+ylab("""")"
"0","  plots2[[ip]]<-plots2[[ip]]+ylab("""")"
"0","}"
"0","for(ip in c(1,2,3,4)){"
"0","  plots1[[ip]]<-plots1[[ip]]+xlab("""")"
"0","}"
"0","plots1[[1]]<-plots1[[1]]+ylab(""NO CARRYOVER \n Improvement in symptoms"")"
"0","plots2[[1]]<-plots2[[1]]+ylab(""WITH CARRYOVER \n Improvement in symptoms"")"
"0",""
"0","lay <- rbind(c(1,1,2,2,2,3,3,3,4,4,4,NA),"
"0","             c(5,5,6,6,6,7,7,7,8,8,8,9))"
"0","plots<-c(plots1,plots2,list(legend))"
"0","grid.arrange(grobs = plots, layout_matrix = lay)"
